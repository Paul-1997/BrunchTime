import{_ as v,c as u,a as s,b as x,e as i,f as r,r as b,E as w,o as c,g as h,m as g,x as y,B as k,t as o,F as L,z as O}from"./index-Cvp84FeK.js";import{u as $}from"./userStore-DeCxQI4D.js";import{p as C}from"./productStore-C97PhnbI.js";import{o as f}from"./orderStore-mTS2Tg5Z.js";import{f as P}from"./formatDate-DjwVwIQF.js";const D={name:"PanelComp",emits:["userLoginOut"],data(){return{panel:null,isPanelOpen:!1}},methods:{togglePanel(){this.panel&&(this.isPanelOpen=!this.isPanelOpen,this.panel.classList.toggle("hidden"))},handleResize(){if(!this.panel)return;const e=window.innerWidth<769;this.isPanelOpen=!e,this.panel.classList.toggle("hidden",e)}},mounted(){this.panel=this.$refs.panel,this.handleResize(),window.addEventListener("resize",this.handleResize)},beforeUnmount(){window.removeEventListener("resize",this.handleResize)},watch:{"$route.query":{handler(){window.innerWidth<768&&this.togglePanel()}}}},R={ref:"panel__wrapper",class:"panel__wrapper vh-100 d-flex z-2 top-0 position-fixed"},z={class:"panel bg-accent d-flex flex-column align-items-center overflow-hidden",ref:"panel"},S={class:"w-100 text-center fs-xl"},V={class:"nav__link mb-3"},B={class:"nav__link mb-3"},N={class:"nav__link mb-3"},E={class:"nav__link mb-3"},M={class:"nav__link"},A={class:"panel__footer mt-auto"},T={class:"d-flex gap-8 pb-6"};function U(e,t,n,m,a,_){const l=b("RouterLink");return c(),u("nav",R,[s("div",z,[t[8]||(t[8]=s("img",{src:x,alt:"logo",class:"home-logo mb-4"},null,-1)),s("ul",S,[s("li",V,[i(l,{class:"py-3 px-2 d-block",to:{name:"dashboard-home"}},{default:r(()=>t[2]||(t[2]=[h("總覽",-1)])),_:1,__:[2]})]),s("li",B,[i(l,{class:"py-3 px-2 d-block",to:{name:"dashboard-products"}},{default:r(()=>t[3]||(t[3]=[h("產品管理",-1)])),_:1,__:[3]})]),s("li",N,[i(l,{class:"py-3 px-2 d-block",to:{name:"dashboard-orders"}},{default:r(()=>t[4]||(t[4]=[h("訂單管理",-1)])),_:1,__:[4]})]),s("li",E,[i(l,{class:"py-3 px-2 d-block",to:{name:"dashboard-articles"}},{default:r(()=>t[5]||(t[5]=[h("文章管理",-1)])),_:1,__:[5]})]),s("li",M,[i(l,{class:"py-3 px-2 d-block",to:{name:"dashboard-coupons"}},{default:r(()=>t[6]||(t[6]=[h("優惠卷管理",-1)])),_:1,__:[6]})])]),s("div",A,[s("ul",T,[s("li",null,[i(l,{to:"/"},{default:r(()=>t[7]||(t[7]=[s("span",{class:"material-symbols-outlined fs-3xl cursor-pointer"},"home",-1)])),_:1,__:[7]})]),s("li",null,[s("span",{class:"material-symbols-outlined fs-3xl cursor-pointer",onClick:t[0]||(t[0]=p=>e.$emit("userLoginOut"))},"logout")])])])],512),s("button",{class:"toggle-btn d-md-none align-self-center",onClick:t[1]||(t[1]=(...p)=>_.togglePanel&&_.togglePanel(...p))},[s("span",{class:w(["material-symbols-outlined transition duration-250",{"rotate-180":a.isPanelOpen}])}," double_arrow ",2)])],512)}const F=v(D,[["render",U],["__scopeId","data-v-04dd8ffd"]]),I={components:{Panel:F},data(){return{recentOrders:[],productCount:0,orderCount:0,monthlyRevenue:0,pendingOrders:0}},computed:{...y(f,["orderList"])},methods:{...g($,["checkLogin","logout"]),...g(C,["getAllProducts"]),...g(f,["getOrders"]),formatDate:P,getStatusClass(e){return{"badge bg-success":e,"badge bg-warning":!e}},async handleDashboardData(){try{const e=await this.getAllProducts("admin")||[];if(await this.getOrders("admin"),e&&(this.productCount=Object.keys(e).length),this.orderList.length){this.orderCount=this.orderList.length,this.recentOrders=this.orderList.slice(0,5);const t=new Date().getMonth();this.monthlyRevenue=this.orderList.filter(n=>new Date(n.create_at).getMonth()===t&&n.is_paid).reduce((n,m)=>n+m.total,0),this.pendingOrders=this.orderList.filter(n=>!n.is_paid).length}}catch{}}},async mounted(){await this.checkLogin(),await this.handleDashboardData()}},W={class:"d-flex"},j={class:"mainDashboardContent flex-grow-1 p-6"},q={key:1,class:"row g-4"},G={class:"col-md-6 col-lg-3"},H={class:"card h-100 border-1 shadow"},J={class:"card-body"},K={class:"card-text fs-2xl"},Q={class:"col-md-6 col-lg-3"},X={class:"card h-100 border-1 shadow"},Y={class:"card-body"},Z={class:"card-text fs-2xl"},ss={class:"col-md-6 col-lg-3"},ts={class:"card h-100 border-1 shadow"},es={class:"card-body"},os={class:"card-text fs-2xl"},ns={class:"col-md-6 col-lg-3"},ls={class:"card h-100 border-1 shadow"},as={class:"card-body"},ds={class:"card-text fs-2xl"},is={class:"order-list-container col-12"},rs={class:"card border-1 shadow h-100 flex-grow-1"},cs={class:"card-body p-0"},_s={class:"table-responsive"},hs={class:"table table-striped table-hover mb-0"};function us(e,t,n,m,a,_){const l=b("Panel"),p=b("RouterView");return c(),u("div",W,[i(l,{onUserLoginOut:e.logout},null,8,["onUserLoginOut"]),s("main",j,[e.$route.name!=="dashboard-home"?(c(),k(p,{key:0})):(c(),u("div",q,[s("div",G,[s("div",H,[s("div",J,[t[0]||(t[0]=s("h5",{class:"card-title text-primary"},"總產品數",-1)),s("p",K,o(a.productCount),1)])])]),s("div",Q,[s("div",X,[s("div",Y,[t[1]||(t[1]=s("h5",{class:"card-title text-success"},"總訂單數",-1)),s("p",Z,o(a.orderCount),1)])])]),s("div",ss,[s("div",ts,[s("div",es,[t[2]||(t[2]=s("h5",{class:"card-title text-info"},"本月營業額",-1)),s("p",os,"NT$ "+o(a.monthlyRevenue),1)])])]),s("div",ns,[s("div",ls,[s("div",as,[t[3]||(t[3]=s("h5",{class:"card-title text-warning"},"待處理訂單",-1)),s("p",ds,o(a.pendingOrders),1)])])]),s("div",is,[s("div",rs,[t[5]||(t[5]=s("div",{class:"card-header bg-white border-0"},[s("h5",{class:"mb-0 fs-4xl fw-bold"},"最新訂單")],-1)),s("div",cs,[s("div",_s,[s("table",hs,[t[4]||(t[4]=s("thead",null,[s("tr",null,[s("th",null,"訂單編號"),s("th",null,"客戶名稱"),s("th",null,"訂單金額"),s("th",null,"訂單狀態"),s("th",null,"建立時間")])],-1)),s("tbody",null,[(c(!0),u(L,null,O(a.recentOrders,d=>(c(),u("tr",{key:d.id},[s("td",null,o(d.id),1),s("td",null,o(d.user.name),1),s("td",null,"NT$ "+o(d.total),1),s("td",null,[s("span",{class:w(_.getStatusClass(d.is_paid))},o(d.is_paid?"已付款":"未付款"),3)]),s("td",null,o(_.formatDate(d.create_at)),1)]))),128))])])])])])])]))])])}const vs=v(I,[["render",us],["__scopeId","data-v-116cbe63"]]);export{vs as default};
