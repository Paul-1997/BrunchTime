import{L as p,H as o,S as u,A as r,I as d}from"./index-BaE2heXT.js";const f={VITE_APP_API_NAME:"paul7426"},{VITE_APP_API_NAME:n}=f,g=p("products",{state(){return{productList:[],pagination:{},onLoading:!1}},actions:{async getProducts(s,a=0,t=""){var i;try{let e=`v2/api/${n}/${s==="admin"?"admin/":""}products`;a>0&&(e+=`?page=${a}`),t!==""&&(e+=a>0?`&category=${t}`:`?category=${t}`),this.onLoading=!0;const{data:c}=await o(e,"get",s==="admin");this.productList=c.products,this.pagination=c.pagination}catch(e){e instanceof r&&d(((i=e.response)==null?void 0:i.data.message)||"錯誤!")}finally{this.onLoading=!1}},async getAllProducts(s){var a;try{const t=`v2/api/${n}/${s==="admin"?"admin/":""}products/all`;this.onLoading=!0;const{data:i}=await o(t,"get",s==="admin");return i}catch(t){return t instanceof r&&d(((a=t.response)==null?void 0:a.data.message)||"錯誤!"),!1}finally{this.onLoading=!1}},async getSingleProduct(s){var a;try{const t=`v2/api/${n}/product/${s}`;this.onLoading=!0;const{data:i}=await o(t,"get");return i}catch(t){return t instanceof r&&(await d((a=t.response)==null?void 0:a.data.message,"取得產品資訊異常",{confirmButtonText:"返回購物列表"})).isConfirmed&&this.$router.push("/products"),!1}finally{this.onLoading=!1}},async deleteProduct(s){var a;try{const t=`v2/api/${n}/admin/product/${s}`;this.onLoading=!0;const{data:i}=await o(t,"delete",!0);i.success&&(u(i.message),this.getProducts("admin"))}catch(t){t instanceof r&&d(((a=t.response)==null?void 0:a.data.message)||"錯誤!")}finally{this.onLoading=!1}},async updateProducts(s){var a;try{const t=s.id?`v2/api/${n}/admin/product/${s.id}`:`v2/api/${n}/admin/product`,i=s.id?"put":"post";this.onLoading=!0;const{data:e}=await o(t,i,!0,{data:{...s}});e.success&&(u(e.message),this.getProducts("admin"))}catch(t){t instanceof r&&d(((a=t.response)==null?void 0:a.data.message)||"")}finally{this.onLoading=!1}}}});export{g as p};
