import{N as k,_ as V,A as T,a as e,t as b,e as n,f as g,T as D,r as _,o as u,c,z as h,F as f,w as C,v as x,g as U,J as P,O,m as I,x as B,d as A,D as E}from"./index-C3VS7dNT.js";import{p as w}from"./productStore-DHSJnlch.js";import{P as L}from"./PaginationComp-6gfPTlfG.js";import{D as N}from"./DeleteModal-BvdaLGMk.js";import{L as H}from"./LoadingComp-036xVdR_.js";function S(r,o=350){let i;return(...v)=>{i&&clearTimeout(i),i=setTimeout(()=>{r(...v)},o)}}const q={props:["product"],emits:["updateProduct"],data(){return{modal:null,deepCloneProduct:{}}},methods:{updateImg({imageUrl:r}){this.deepCloneProduct.imageUrl=r},openModal(){this.modal.show()},closeModal(){this.modal.hide(),this.$refs.form.resetForm()},emitUpdate(){const r=Date.now();this.deepCloneProduct.createAt||(this.deepCloneProduct.createAt=r),this.deepCloneProduct.updateAt=r,this.$emit("updateProduct",this.deepCloneProduct),this.closeModal()},addImages(){this.deepCloneProduct.imagesUrl?this.deepCloneProduct.imagesUrl=[...this.deepCloneProduct.imagesUrl,""]:this.deepCloneProduct.imagesUrl=[""]},doDebounce:S((r,o,i)=>{const v=r;v[o]=i}),handleImgGroupInput(r,o){this.doDebounce(this.deepCloneProduct.imagesUrl,o,r)}},mounted(){this.modal=new k(this.$refs.productModal)},watch:{product(){this.deepCloneProduct=JSON.parse(JSON.stringify(this.product))}}},G="/BrunchTime/not-found.png",J={class:"modal fade",id:"ProductModal",tabindex:"-1","aria-labelledby":"ProductModalLabel","aria-hidden":"true","data-bs-backdrop":"static",ref:"productModal"},j={class:"modal-dialog modal-xl modal-dialog-centered"},z={class:"modal-content"},K={class:"modal-header bg-accent"},Q={class:"modal-title fw-bold fs-2xl",id:"ProductModalLabel"},R={class:"modal-body d-flex flex-column flex-lg-row gap-4"},W={class:"col-lg-4 col-12 d-flex flex-column"},X={class:"border rounded border-neutral mb-3"},Y=["src"],Z={class:"productImageGroup mb-5"},$=["src","alt"],ee={key:1,src:G,class:"border border-neutral rounded",alt:""},oe={class:"form-group mb-2 border border-info border-2 p-2 rounded"},te={class:"form-group mb-2 border border-natural-light border-2 p-2 rounded"},le=["for"],re=["onClick"],se=["value","onInput"],de={class:"flex-grow-1"},ne={class:"row mb-3"},ue={class:"col-sm-9 col-12"},ie={class:"row mb-3"},ce={class:"col-sm-9 col-12"},ae={class:"row mb-3"},me={class:"d-flex flex-wrap col-lg-6 col-xl-3 mb-3"},pe={class:"col-sm-9 col-12 input__extraFix"},be={class:"d-flex flex-wrap col-lg-6 col-xl-3 mb-3"},ge={class:"col-sm-9 col-12 input__extraFix"},_e={class:"d-flex flex-wrap col-lg-6 col-xl-3 mb-3"},fe={class:"col-sm-9 col-12 input__extraFix"},Pe={class:"d-flex flex-wrap col-lg-6 col-xl-3 mb-3"},ve={class:"col-sm-9 col-12 input__extraFix"},Ce={class:"row mb-3"},he={class:"col-sm-9 col-12"},ye={class:"row mb-8"},xe={class:"col-sm-9 col-12"},Me={class:"mb-3 px-3"},we={class:"form-check form-switch"},Fe={class:"modal-footer"},Ve={type:"submit",class:"px-6 btn btn-success"};function Ue(r,o,i,v,l,d){const m=_("VeeField"),p=_("VeeErrorMessage"),y=_("VeeForm");return u(),T(D,{to:"body"},[e("div",J,[e("div",j,[e("div",z,[e("div",K,[e("h5",Q,b(i.product.id?"編輯產品":"新增產品"),1),e("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:o[0]||(o[0]=(...a)=>d.closeModal&&d.closeModal(...a))})]),n(y,{ref:"form",onSubmit:d.emitUpdate},{default:g(({errors:a})=>[e("div",R,[e("div",W,[e("div",X,[e("img",{src:l.deepCloneProduct.imageUrl,alt:"",class:"product__mainImage"},null,8,Y)]),e("div",Z,[(u(!0),c(f,null,h(l.deepCloneProduct.imagesUrl,(t,s)=>(u(),c(f,{key:t},[t!==""?(u(),c("img",{key:0,src:t,alt:`productImages${s+1}`,class:"border border-neutral rounded"},null,8,$)):(u(),c("img",ee))],64))),128))]),e("div",null,[e("div",oe,[o[13]||(o[13]=e("label",{for:"editMainImage",class:"form-label"},"主圖",-1)),C(e("input",{type:"text",class:"form-control",id:"editMainImage","onUpdate:modelValue":o[1]||(o[1]=t=>l.deepCloneProduct.imageUrl=t)},null,512),[[x,l.deepCloneProduct.imageUrl]])]),o[15]||(o[15]=e("hr",{class:"my-1"},null,-1)),(u(!0),c(f,null,h(l.deepCloneProduct.imagesUrl,(t,s)=>(u(),c(f,{key:s+"."+t},[e("div",te,[e("label",{for:"moreImg"+s,class:"form-label d-flex"},[U("圖片"+b(s+1)+" ",1),e("span",{class:"btn btn-close align-middle ms-auto",onClick:M=>l.deepCloneProduct.imagesUrl.splice(s,1)},null,8,re)],8,le),e("input",{type:"text",class:"form-control",value:l.deepCloneProduct.imagesUrl[s],onInput:M=>d.handleImgGroupInput(M.target.value,s)},null,40,se)]),o[14]||(o[14]=e("hr",{class:"my-1"},null,-1))],64))),128)),e("button",{type:"button",class:"btn btn-success btn-sm",onClick:o[2]||(o[2]=(...t)=>d.addImages&&d.addImages(...t))}," 新增副圖 ")])]),e("div",de,[e("div",ne,[o[16]||(o[16]=e("label",{for:"inputProductTitle",class:"col-sm-3 col-12 col-form-label"}," 產品名稱 ",-1)),e("div",ue,[n(m,{modelValue:l.deepCloneProduct.title,"onUpdate:modelValue":o[3]||(o[3]=t=>l.deepCloneProduct.title=t),type:"text",rules:"required",name:"productTitle",label:"產品名稱"},{default:g(({field:t,meta:s})=>[e("input",P({id:"inputProductTitle"},t,{class:["form-control border border-neutral",{"is-invalid":a.productTitle,"is-valid":s.valid&&s.touched}]}),null,16)]),_:2},1032,["modelValue"])]),n(p,{name:"productTitle",class:"Vee__errMsg"})]),e("div",ie,[o[17]||(o[17]=e("label",{for:"inputProductCategory",class:"col-sm-3 col-12 col-form-label"},"產品種類",-1)),e("div",ce,[n(m,{modelValue:l.deepCloneProduct.category,"onUpdate:modelValue":o[4]||(o[4]=t=>l.deepCloneProduct.category=t),type:"text",rules:"required",name:"productCategory",label:"產品種類"},{default:g(({field:t,meta:s})=>[e("input",P({id:"inputProductCategory"},t,{class:["form-control border border-neutral",{"is-invalid":a.productCategory,"is-valid":s.valid&&s.touched}]}),null,16)]),_:2},1032,["modelValue"])]),n(p,{name:"productCategory",class:"Vee__errMsg"})]),e("div",ae,[e("div",me,[o[18]||(o[18]=e("label",{for:"inputProductOriginPrice",class:"col-sm-3 col-12 col-form-label"},"原價",-1)),e("div",pe,[n(m,{modelValue:l.deepCloneProduct.origin_price,"onUpdate:modelValue":o[5]||(o[5]=t=>l.deepCloneProduct.origin_price=t),modelModifiers:{number:!0},type:"number",rules:"integer|required",name:"ProductOriginPrice",label:"原價"},{default:g(({field:t,meta:s})=>[e("input",P(t,{class:["form-control border border-neutral",{"is-invalid":a.ProductOriginPrice,"is-valid":s.valid&&s.touched}],id:"inputProductOriginPrice",inputmode:"numeric"}),null,16)]),_:2},1032,["modelValue"]),n(p,{name:"ProductOriginPrice",class:"Vee__errMsg"})])]),e("div",be,[o[19]||(o[19]=e("label",{for:"inputProductPrice",class:"col-sm-3 col-12 col-form-label"},"定價",-1)),e("div",ge,[n(m,{modelValue:l.deepCloneProduct.price,"onUpdate:modelValue":o[6]||(o[6]=t=>l.deepCloneProduct.price=t),modelModifiers:{number:!0},type:"number",rules:"integer|required",name:"ProductPrice",label:"定價"},{default:g(({field:t,meta:s})=>[e("input",P(t,{class:["form-control border border-neutral",{"is-invalid":a.ProductPrice,"is-valid":s.valid&&s.touched}],id:"inputProductPrice",inputmode:"numeric"}),null,16)]),_:2},1032,["modelValue"]),n(p,{name:"ProductPrice",class:"Vee__errMsg"})])]),e("div",_e,[o[20]||(o[20]=e("label",{for:"inputProductNum",class:"col-sm-3 col-12 col-form-label"},"數量",-1)),e("div",fe,[n(m,{modelValue:l.deepCloneProduct.num,"onUpdate:modelValue":o[7]||(o[7]=t=>l.deepCloneProduct.num=t),modelModifiers:{number:!0},type:"number",rules:"integer|required",name:"ProductNum",label:"數量"},{default:g(({field:t,meta:s})=>[e("input",P(t,{class:["form-control border border-neutral",{"is-invalid":a.ProductNum,"is-valid":s.valid&&s.touched}],id:"inputProductNum",inputmode:"numeric"}),null,16)]),_:2},1032,["modelValue"]),n(p,{name:"ProductNum",class:"Vee__errMsg"})])]),e("div",Pe,[o[21]||(o[21]=e("label",{for:"inputProductUnit",class:"col-sm-3 col-12 col-form-label"},"單位",-1)),e("div",ve,[n(m,{modelValue:l.deepCloneProduct.unit,"onUpdate:modelValue":o[8]||(o[8]=t=>l.deepCloneProduct.unit=t),type:"text",rules:"required",name:"ProductUnit",label:"單位"},{default:g(({field:t,meta:s})=>[e("input",P(t,{class:["form-control border border-neutral",{"is-invalid":a.ProductUnit,"is-valid":s.valid&&s.touched}],id:"inputProductUnit"}),null,16)]),_:2},1032,["modelValue"]),n(p,{name:"ProductUnit",class:"Vee__errMsg"})])])]),e("div",Ce,[o[22]||(o[22]=e("label",{for:"inputProductContent",class:"col-sm-3 col-12 col-form-label"},"產品內容",-1)),e("div",he,[C(e("textarea",{type:"text",class:"form-control border border-neutral",id:"inputProductContent",placeholder:"請輸入產品內容","onUpdate:modelValue":o[9]||(o[9]=t=>l.deepCloneProduct.content=t),style:{"min-height":"100px"}},null,512),[[x,l.deepCloneProduct.content]])])]),e("div",ye,[o[23]||(o[23]=e("label",{for:"inputProductDesc",class:"col-sm-3 col-12 col-form-label"},"產品描述",-1)),e("div",xe,[C(e("textarea",{id:"inputProductDesc",class:"form-control border border-neutral",style:{"min-height":"150px"},"aria-describedby":"inputProductDesc","onUpdate:modelValue":o[10]||(o[10]=t=>l.deepCloneProduct.description=t),placeholder:"請輸入產品描述"},null,512),[[x,l.deepCloneProduct.description]])])]),e("div",Me,[e("div",we,[C(e("input",{class:"form-check-input py-2 border border-neutral me-5",type:"checkbox",role:"switch",id:"inputProductIsEnable","true-value":1,"false-value":0,"onUpdate:modelValue":o[11]||(o[11]=t=>l.deepCloneProduct.is_enabled=t),style:{scale:"1.5"}},null,512),[[O,l.deepCloneProduct.is_enabled]]),o[24]||(o[24]=e("label",{class:"form-check-label",for:"inputProductIsEnable"},"是否啟用",-1))])])])]),e("div",Fe,[e("button",{type:"button",class:"px-6 btn btn-outline-neutral",onClick:o[12]||(o[12]=(...t)=>d.closeModal&&d.closeModal(...t))},"取消"),e("button",Ve,b(i.product.id?"編輯":"新增"),1)])]),_:1},8,["onSubmit"])])])],512)])}const ke=V(q,[["render",Ue],["__scopeId","data-v-91f8c502"]]),F={category:"種類",highest_price:'價格<span class="material-symbols-outlined fs-base ms-2">arrow_upward</span>',lowest_price:'價格<span class="material-symbols-outlined fs-base ms-2">arrow_downward</span>',is_enable:"是否啟用"},Te={data(){return{orderOption:[...Object.keys(F)],currentOrderType:"category",tempProduct:{}}},methods:{...I(w,["getProducts","updateProducts","deleteProduct"]),async getNewProduct(r){await this.getProducts("admin",r)},currentOrderHTML(r){return F[r]},changeOrder(r){this.currentOrderType=r},getModal(r,o){const i=this.$refs[r];this.tempProduct={...o},i.openModal()}},computed:{...B(w,["productList","pagination","onLoading"]),orderedProduct(){return[...this.productList].sort((r,o)=>this.currentOrderType==="highest_price"?r.price-o.price:this.currentOrderType==="lowest_price"?o.price-r.price:this.currentOrderType==="is_enable"?r.is_enabled>=o.is_enabled?1:0:r.category.localeCompare(o.category))}},async mounted(){await this.getProducts("admin")},components:{ProductModal:ke,DeleteModal:N,Pagination:L,Loading:H}},De={class:"container mx-auto"},Oe={class:"toolbar mb-3 d-flex align-items-center justify-content-end gap-3"},Ie={class:"dropdown"},Be=["innerHTML"],Ae={class:"dropdown-menu","aria-labelledby":"orderDropdown"},Ee=["onClick"],Le=["innerHTML"],Ne={class:"mb-10"},He={class:"row"},Se={class:"me-md-2"},qe=["src"],Ge={class:"badge bg-secondary d-none d-md-inline"},Je={class:"col-3 fs-md-lg fs-lg-xl"},je={class:"fs-lg"},ze={class:"button-group ms-auto"},Ke=["onClick"],Qe=["onClick"];function Re(r,o,i,v,l,d){const m=_("Pagination"),p=_("Loading"),y=_("ProductModal"),a=_("DeleteModal");return u(),c(f,null,[e("div",De,[o[2]||(o[2]=e("h2",{class:"fw-bold fs-4xl text-center text-secondary my-10"},"產品管理",-1)),e("div",Oe,[e("div",Ie,[e("button",{class:"btn dropdown-toggle d-flex align-items-center",type:"button",id:"orderDropdown","data-bs-toggle":"dropdown","aria-expanded":"false",innerHTML:d.currentOrderHTML(l.currentOrderType)},null,8,Be),e("ul",Ae,[(u(!0),c(f,null,h(l.orderOption,t=>(u(),c("li",{key:`order${t}`},[e("a",{class:"dropdown-item",href:"#",onClick:A(s=>d.changeOrder(t),["prevent"])},[e("span",{innerHTML:d.currentOrderHTML(t),class:"d-flex align-items-center"},null,8,Le)],8,Ee)]))),128))])]),e("button",{type:"button",class:"btn btn-accent",onClick:o[0]||(o[0]=t=>d.getModal("productModal",{}))},"新增產品")]),e("div",Ne,[e("ul",He,[(u(!0),c(f,null,h(d.orderedProduct,t=>(u(),c("li",{class:"d-flex align-items-center gap-2 bg-primary rounded p-3 mb-4",key:t.id},[e("div",Se,[e("img",{src:t.imageUrl,alt:"",class:"product__image"},null,8,qe)]),e("div",Ge,b(t.category),1),e("div",Je,b(t.title),1),e("div",null,[e("span",je,b(t.price),1),U(" / "+b(t.unit),1)]),e("div",{class:E(["ms-auto badge",t.is_enabled?"bg-success":"bg-neutral"])},b(t.is_enabled?"已啟用":"未啟用"),3),e("div",ze,[e("span",{class:"material-symbols-outlined interactive-button me-md-3 cursor-pointer",onClick:s=>d.getModal("productModal",t)}," edit ",8,Ke),e("span",{class:"material-symbols-outlined interactive-button cursor-pointer",onClick:s=>d.getModal("deleteModal",t)}," delete ",8,Qe)])]))),128))])]),n(m,{pagination:r.pagination,onUpdatePage:d.getNewProduct},null,8,["pagination","onUpdatePage"])]),n(p,{active:r.onLoading},null,8,["active"]),n(y,{ref:"productModal",product:l.tempProduct,onUpdateProduct:r.updateProducts},null,8,["product","onUpdateProduct"]),n(a,{ref:"deleteModal",title:l.tempProduct.title,"target-id":l.tempProduct.id,onDeleteTarget:o[1]||(o[1]=async t=>await r.deleteProduct(t))},null,8,["title","target-id"])],64)}const eo=V(Te,[["render",Re],["__scopeId","data-v-732dc5ea"]]);export{eo as default};
